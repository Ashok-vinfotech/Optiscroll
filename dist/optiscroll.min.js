!function(a,b,c){"use strict";function d(){var a,c,d=b.documentElement,e=0;return a=b.createElement("div"),a.style.cssText="overflow:auto;width:50px;height:50px;position:absolute;left:-100px",c=b.createElement("div"),c.style.cssText="width:100px;height:100px",a.appendChild(c),d.appendChild(a),e=a.offsetWidth-a.clientWidth,d.removeChild(a),e}function e(a){var d=a.charAt(0).toUpperCase()+a.slice(1),e=b.createElement("test"),f=(a+" "+["Webkit","Moz","O","ms"].join(d+" ")+d).split(" ");for(var g in f)if(e.style[f[g]]!==c)return f[g];return!1}function f(a,b,d){for(var e in b)!b.hasOwnProperty(e)||a[e]!==c&&d||(a[e]=b[e]);return a}function g(a,b,c){var d,e,f;if(a.length)for(d=0,e=a.length;e>d;d++)a[d][b]&&a[d][b].apply(a[d],c);else for(f in a)a.hasOwnProperty(f)&&a[f][b]&&a[f][b].apply(a[f],c)}{var h=function p(a,b){return new p.Instance(a,b||{})},i=h.globalSettings={scrollMinUpdateInterval:1e3/60,checkFrequency:1e3,pauseCheck:!1};h.defaults={fixTouchPageBounce:!0,forcedScrollbars:!1,scrollStopDelay:300,maxTrackSize:95,minTrackSize:5,draggableTracks:!0,autoUpdate:!0,classPrefix:"optiscroll"}}h.Instance=function(a,b){this.element=a,this.scrollEl=a.children[0],this.settings=f(f({},h.defaults),b||{}),this.cache={},this.init()},h.Instance.prototype.init=function(){var a=m.nativeScrollbarSize||this.settings.forcedScrollbars;this.settings.autoUpdate&&m.instances.push(this),this.scrollbars={v:new k("v",this),h:new k("h",this)},a&&(l.hideNativeScrollbars(this.scrollEl),g(this.scrollbars,"create")),m.isTouch&&this.settings.fixTouchPageBounce&&this.element.classList.add(this.settings.classPrefix+"-touchfix"),this.update(),this.bindEvents(),m.checkTimer||l.checkLoop()},h.Instance.prototype.bindEvents=function(){var a=this,b=this.listeners={},c=this.scrollEl;b.scroll=function(b){j.scroll.call(a,b)},c.addEventListener("scroll",b.scroll),b.overflow=function(){a.update()},c.addEventListener("overflow",b.overflow),c.addEventListener("underflow",b.overflow),c.addEventListener("overflowchanged",b.overflow),m.isTouch&&(b.touchstart=function(b){j.touchstart.call(a,b)},c.addEventListener("touchstart",b.touchstart),b.touchmove=function(b){j.touchmove.call(a,b)},c.addEventListener("touchmove",b.touchmove))},h.Instance.prototype.update=function(){var a=this.cache.clientHeight,b=this.scrollEl,d=this.cache,e=b.scrollHeight,f=b.clientHeight,g=b.scrollWidth,h=b.clientWidth;if(e!==d.scrollHeight||f!==d.clientHeight||g!==d.scrollWidth||h!==d.clientWidth){if(0===e&&0===f&&null===this.element.parentNode)return this.destroy(),!1;d.scrollHeight=e,d.clientHeight=f,d.scrollWidth=g,d.clientWidth=h,a!==c&&this.fireCustomEvent("sizechange"),j.scrollStop.call(this)}},h.Instance.prototype.scrollTo=function(a,b,c,d){var e,f,g,h,i=this,j=this.scrollEl,k=this.cache;m.pauseCheck=!0,this.update(),e=g=j.scrollLeft,f=h=j.scrollTop,"string"==typeof a?g="left"===a?0:k.scrollWidth-k.clientWidth:"number"==typeof a&&(g=a),"string"==typeof b?h="top"===b?0:k.scrollHeight-k.clientHeight:"number"==typeof b&&(h=b),this.disableScrollEvent=d,0===c?(j.scrollLeft=g,j.scrollTop=h,o(function(){i.disableScrollEvent=!1})):this.animateScroll(e,g,f,h,c||"auto")},h.Instance.prototype.scrollIntoView=function(a,b,c){var d,e,f,g,h,i,j,k,l,n,o=this.scrollEl;m.pauseCheck=!0,this.update(),"string"==typeof a&&(a=o.querySelector(a)),a.length&&a.jquery&&(a=a[0]),"number"==typeof c&&(c={top:c,right:c,bottom:c,left:c}),c=c||{},d=a.getBoundingClientRect(),e=o.getBoundingClientRect(),j=l=o.scrollLeft,k=n=o.scrollTop,f=j+d.left-e.left-(c.left||0),g=k+d.top-e.top-(c.top||0),h=j+d.left-e.left+d.width-e.width+(c.right||0),i=k+d.top-e.top+d.height-e.height+(c.bottom||0),(j>f||h>j)&&(l=j>f?f:h),(k>g||i>k)&&(n=k>g?g:i),0>l&&(l=0),0>n&&(n=0),(l!==j||n!==k)&&(0===b?(o.scrollLeft=l,o.scrollTop=n):this.animateScroll(j,l,k,n,b||"auto"))},h.Instance.prototype.destroy=function(){var a=this.scrollEl,b=this.listeners,c=m.instances.indexOf(this);c>-1&&m.instances.splice(c,1),a.removeEventListener("scroll",b.scroll),a.removeEventListener("overflow",b.overflow),a.removeEventListener("underflow",b.overflow),a.removeEventListener("overflowchanged",b.overflow),a.removeEventListener("touchstart",b.touchstart),a.removeEventListener("touchmove",b.touchmove),g(this.scrollbars,"remove"),a.removeAttribute("style")},h.Instance.prototype.animateScroll=function(a,b,c,d,e){var f=this,g=this.scrollEl,h=n();"auto"===e&&(e=15*Math.pow(Math.max(Math.abs(b-a),Math.abs(d-c)),.62)),"number"!=typeof e&&(e=500);var i=function(){var j=Math.min(1,(n()-h)/e),k=easingFunction(j);d!==c&&(g.scrollTop=k*(d-c)+c),b!==a&&(g.scrollLeft=k*(b-a)+a),1>j?o(i):f.disableScrollEvent=!1};o(i)},h.Instance.prototype.fireCustomEvent=function(a){var b=l.exposedData(this.cache),c=new CustomEvent(a,{detail:b});this.element.dispatchEvent(c)};var j=h.Events={};j.scroll=function(){var a=this,b=this.cache,c=n();this.disableScrollEvent||(m.pauseCheck||m.isTouch||this.element.classList.add(this.settings.classPrefix+"-scrolling"),m.pauseCheck=!0,(!i.scrollMinUpdateInterval||c-(b.scrollNow||0)>=i.scrollMinUpdateInterval)&&(g(this.scrollbars,"update"),b.scrollNow=c,clearTimeout(this.scrollStopTimer),this.scrollStopTimer=setTimeout(function(){j.scrollStop.call(a)},this.settings.scrollStopDelay)))},j.touchstart=function(){clearTimeout(this.scrollStopTimer),this.settings.fixTouchPageBounce&&g(this.scrollbars,"update",[!0]),this.cache.scrollNow=n()},j.touchmove=function(){m.pauseCheck=!0},j.scrollStop=function(){clearTimeout(this.scrollStopTimer),m.isTouch||this.element.classList.remove(this.settings.classPrefix+"-scrolling"),g(this.scrollbars,"update"),this.fireCustomEvent("scrollstop"),m.pauseCheck=!1};var k=function(a,c){var d="v"===a,e=c.element,g=c.scrollEl,h=c.settings,i=c.cache,j=i[a]={},k=d?"Height":"Width",l="client"+k,n="scroll"+k,o=d?"scrollTop":"scrollLeft",p=d?["top","bottom"]:["left","right"],q=!1,r=null,s=null,t=null,u=!1;return{toggle:function(b){q=b,q?e.classList.add(a+"track-on"):e.classList.remove(a+"track-on"),s&&q&&(s.style[m.cssTransition]=m.trackTransitions)},create:function(){r=b.createElement("div"),s=b.createElement("b"),r.className=h.classPrefix+"-"+a,s.className=h.classPrefix+"-"+a+"track",r.appendChild(s),e.appendChild(r),h.draggableTracks&&this.bind()},update:function(a){var b,c,e,r=h.minTrackSize||0,t=h.maxTrackSize||100;b=this.calc(g[o],i[l],i[n],r,t),c=1/b.size*b.position*100,e=Math.abs(b.position-j.position)*i[l],1===b.size&&q&&this.toggle(!1),b.size<1&&!q&&this.toggle(!0),s&&q&&(j.size!==b.size&&(s.style[k.toLowerCase()]=100*b.size+"%"),m.isTouch&&e>20?this.animateTrack():u&&this.removeTrackAnimation(),m.cssTransform?s.style[m.cssTransform]="translate("+(d?"0,"+c+"%":c+"%,0")+")":s.style[p[0]]=100*b.position+"%"),j=f(j,b),this.checkEdges(a)},animateTrack:function(){u=!0,s.style[m.cssTransition]=m.trackTransitions+", "+m.cssTransformDashed+" 0.2s linear 0s"},removeTrackAnimation:function(){u=!1,s.style[m.cssTransition]=m.trackTransitions},bind:function(){var a=function(a){var b=a.touches?a.touches[0]:a;t={x:b.pageX,y:b.pageY,scroll:g[o]}},b=function(a){var b,c,e=a.touches?a.touches[0]:a;t&&(a.preventDefault(),b=d?e.pageY-t.y:e.pageX-t.x,c=b/i[l],g[o]=t.scroll+c*i[n])},c=function(){t=null};s.addEventListener("mousedown",a),s.addEventListener("touchstart",a),r.addEventListener("mousemove",b),r.addEventListener("touchmove",b),r.addEventListener("mouseup",c),r.addEventListener("touchend",c)},calc:function(a,b,c,d,e){var f,g,h,i=d/100,j=e/100;return f=b/c,1===f||0===c?{position:0,size:1,percent:0}:(g=a/c,h=100*a/(c-b),f>j&&(g+=(f-j)*(h/100),f=j),i>f&&(g+=(f-i)*(h/100),f=i),0>h&&(g=0),h>100&&(g=1-f),{position:g,size:f,percent:h})},checkEdges:function(a){var b,e=j.percent;q&&(j.was===e||e%100!==0||a||(c.fireCustomEvent("scrollreachedge"),c.fireCustomEvent("scrollreach"+p[e/100])),e%100===0&&a&&h.fixTouchPageBounce&&(b=e?j.position*i[n]-1:1,c.scrollTo(d?!1:b,d?b:!1,0,!0)),j.was=e)},remove:function(){r&&e.removeChild(r)}}},l=h.Utils={};l.hideNativeScrollbars=function(a){if(0===m.nativeScrollbarSize){var b=n();a.setAttribute("data-scroll",b),m.isTouch?(a.style.display="none",l.addCssRule('[data-scroll="'+b+'"]::-webkit-scrollbar',"display: none;"),o(function(){a.style.display="block"})):l.addCssRule('[data-scroll="'+b+'"]::-webkit-scrollbar',"width: 0; height: 0;")}else a.style.overflow="scroll",a.style.right=-m.nativeScrollbarSize+"px",a.style.bottom=-m.nativeScrollbarSize+"px"},l.exposedData=function(a){return{scrollbarV:f({},a.v),scrollbarH:f({},a.h),scrollTop:a.v.position*a.scrollHeight,scrollLeft:a.h.position*a.scrollWidth,scrollBottom:(1-a.v.position)*a.scrollHeight,scrollRight:(1-a.h.position)*a.scrollWidth,scrollWidth:a.scrollWidth,scrollHeight:a.scrollHeight,clientWidth:a.clientWidth,clientHeight:a.clientHeight}},l.addCssRule=function(a,c){var d=b.getElementById("scroll-sheet");d||(d=b.createElement("style"),d.appendChild(b.createTextNode("")),d.id="scroll-sheet",b.head.appendChild(d)),d.sheet.insertRule?d.sheet.insertRule(a+"{"+c+"}",0):d.sheet.addRule(a,c)},l.checkLoop=function(){return m.instances.length?(m.pauseCheck||g(m.instances,"update"),void(i.checkFrequency&&(m.checkTimer=setTimeout(function(){l.checkLoop()},i.checkFrequency)))):void(m.checkTimer=null)},l.easingFunction=function(a){return--a*a*a+1};var m={isTouch:"ontouchstart"in a,cssTransition:e("transition"),cssTransform:e("transform"),cssTransformDashed:"",trackTransitions:"height 0.2s ease 0s, width 0.2s ease 0s, opacity 0.2s ease 0s",nativeScrollbarSize:d(),instances:[],checkTimer:null,pauseCheck:!1};m.cssTransformDashed="transform"==m.cssTransform?m.cssTransform:"-"+m.cssTransform.replace("T","-t").toLowerCase();var n=Date.now||function(){return(new Date).getTime()},o=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.msRequestAnimationFrame||a.oRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)}}();"classList"in b.documentElement||!Object.defineProperty||"undefined"==typeof HTMLElement||Object.defineProperty(HTMLElement.prototype,"classList",{get:function(){function a(a){return function(c){var d=b.className.split(/\s+/),e=d.indexOf(c);a(d,e,c),b.className=d.join(" ")}}var b=this,c={add:a(function(a,b,c){~b||a.push(c)}),remove:a(function(a,b){~b&&a.splice(b,1)})};return c}}),function(){function d(a,d){d=d||{bubbles:!1,cancelable:!1,detail:c};var e=b.createEvent("CustomEvent");return e.initCustomEvent(a,d.bubbles,d.cancelable,d.detail),e}d.prototype=a.Event.prototype,"CustomEvent"in a||(a.CustomEvent=d)}(),"function"==typeof define&&define.amd&&define(function(){return h}),"undefined"!=typeof module&&module.exports&&(module.exports=h),a.OptiScroll=h}(window,document);