/*!
 * Optiscroll.js v1.0.0
 * https://github.com/wilsonfletcher/Optiscroll/
 * by Alberto Gasparin
 * 
 * @copyright 2014 Wilson Fletcher
 * @license Released under MIT license
 */
!function(a,b,c,d){"use strict";function e(){var a,c,d=b.documentElement,e=0;return a=b.createElement("div"),a.style.cssText="overflow:auto;width:50px;height:50px;position:absolute;left:-100px",c=b.createElement("div"),c.style.cssText="width:100px;height:100px",a.appendChild(c),d.appendChild(a),e=a.offsetWidth-a.clientWidth,d.removeChild(a),e}function f(a){var c=a.charAt(0).toUpperCase()+a.slice(1),e=b.createElement("test"),f=(a+" "+["Webkit","Moz","O","ms"].join(c+" ")+c).split(" ");for(var g in f)if(e.style[f[g]]!==d)return f[g];return!1}function g(a,b,c){var d=a.className.split(/\s+/),e=d.indexOf(b);c?~e||d.push(b):~e&&d.splice(e,1),a.className=d.join(" ")}function h(a,b,c){for(var e in b)!b.hasOwnProperty(e)||a[e]!==d&&c||(a[e]=b[e]);return a}function i(a,b,c){var d,e;if(a.length)for(d=0,e=a.length;e>d;d++)a[d][b].apply(a[d],c);else for(d in a)a[d][b].apply(a[d],c)}"function"==typeof a.CustomEvent||function(a){function c(a,c){c=c||{bubbles:!1,cancelable:!1,detail:d};var e=b.createEvent("CustomEvent");return e.initCustomEvent(a,c.bubbles,c.cancelable,c.detail),e}c.prototype=a.Event.prototype,a.CustomEvent=c}(a);var j=function r(a,b){return new r.Instance(a,b||{})},k=j.globalSettings={scrollMinUpdateInterval:25,checkFrequency:1e3,pauseCheck:!1};j.defaults={preventParentScroll:!1,forceScrollbars:!1,scrollStopDelay:300,maxTrackSize:95,minTrackSize:5,draggableTracks:!0,autoUpdate:!0,classPrefix:"optiscroll"},j.Instance=function(a,b){var c=this;c.element=a,c.scrollEl=a.children[0],c.settings=h(h({},j.defaults),b||{}),c.cache={},c.init()},j.Instance.prototype.init=function(){var b=this,c=b.settings;c.autoUpdate&&o.instances.push(b),b.scrollbars={v:new m("v",b),h:new m("h",b)},0===o.nativeScrollbarSize&&"mozRequestAnimationFrame"in a&&(c.forceScrollbars=!1),(o.nativeScrollbarSize||c.forceScrollbars)&&(n.hideNativeScrollbars(b.scrollEl),i(b.scrollbars,"create")),o.isTouch&&c.preventParentScroll&&g(b.element,c.classPrefix+"-nobounce",!0),b.update(),b.bind(),c.autoUpdate&&!o.checkTimer&&n.checkLoop()},j.Instance.prototype.bind=function(){var a=this,b=a.listeners={},c=a.scrollEl;b.scroll=function(b){l.scroll(b,a)},b.overflow=b.underflow=b.overflowchanged=function(){a.update()},o.isTouch&&(b.touchstart=function(b){l.touchstart(b,a)},b.touchend=function(b){l.touchend(b,a)}),a.settings.preventParentScroll&&(b.mousewheel=b.wheel=function(b){l.wheel(b,a)});for(var d in b)c.addEventListener(d,b[d])},j.Instance.prototype.update=function(){var a=this,c=a.cache.clientH,e=a.scrollEl,f=a.cache,g=e.scrollHeight,h=e.clientHeight,j=e.scrollWidth,k=e.clientWidth;if(g!==f.scrollH||h!==f.clientH||j!==f.scrollW||k!==f.clientW){if(0===g&&0===h&&!b.body.contains(a.element))return a.destroy(),!1;f.scrollH=g,f.clientH=h,f.scrollW=j,f.clientW=k,c!==d&&a.fireCustomEvent("sizechange"),i(a.scrollbars,"update")}},j.Instance.prototype.scrollTo=function(a,b,c,d){var e,f,g,h,i=this,j=i.cache;o.pauseCheck=!0,i.update(),e=g=i.scrollEl.scrollLeft,f=h=i.scrollEl.scrollTop,"string"==typeof a?g="left"===a?0:j.scrollW-j.clientW:"number"==typeof a&&(g=a),"string"==typeof b?h="top"===b?0:j.scrollH-j.clientH:"number"==typeof b&&(h=b),i.disableScrollEv=d,i.animateScroll(e,g,f,h,c)},j.Instance.prototype.scrollIntoView=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,p=n.scrollEl;o.pauseCheck=!0,n.update(),"string"==typeof a&&(a=p.querySelector(a)),a.length&&a.jquery&&(a=a[0]),"number"==typeof c&&(c={top:c,right:c,bottom:c,left:c}),c=c||{},d=a.getBoundingClientRect(),e=p.getBoundingClientRect(),j=l=p.scrollLeft,k=m=p.scrollTop,f=j+d.left-e.left-(c.left||0),g=k+d.top-e.top-(c.top||0),h=j+d.left-e.left+d.width-n.cache.clientW+(c.right||0),i=k+d.top-e.top+d.height-n.cache.clientH+(c.bottom||0),(j>f||h>j)&&(l=j>f?f:h),(k>g||i>k)&&(m=k>g?g:i),n.animateScroll(j,l,k,m,b)},j.Instance.prototype.animateScroll=function(a,b,d,e,f){var g=this,h=g.scrollEl,i=p();if(b!==a||e!==d){if(0===f)return h.scrollLeft=b,h.scrollTop=e,void q(function(){g.disableScrollEv=!1});"number"!=typeof f&&(f=15*c.pow(c.max(c.abs(b-a),c.abs(e-d)),.62));var j=function(){var k=c.min(1,(p()-i)/f),l=n.easingFunction(k);e!==d&&(h.scrollTop=l*(e-d)+d),b!==a&&(h.scrollLeft=l*(b-a)+a),1>k?q(j):g.disableScrollEv=!1};q(j)}},j.Instance.prototype.destroy=function(){var a=this,b=a.scrollEl,c=a.listeners,d=o.instances.indexOf(a);for(var e in c)b.removeEventListener(e,c[e]);i(a.scrollbars,"remove"),b.removeAttribute("style"),b.removeAttribute("data-scroll"),g(a.element,a.settings.classPrefix+"-nobounce",!1),d>-1&&q(function(){o.instances.splice(d,1)})},j.Instance.prototype.fireCustomEvent=function(a){var b=n.exposedData(this.cache),c=new CustomEvent(a,{detail:b});this.element.dispatchEvent(c)};var l={scrollTimer:null,stopTimer:null,scroll:function(b,c){var d=c.cache,e=p(),f="matchMedia"in a?k.scrollMinUpdateInterval:0;c.disableScrollEv||(o.pauseCheck||c.fireCustomEvent("scrollstart"),o.pauseCheck=!0,(!d.now||e>d.now+k.scrollMinUpdateInterval)&&(d.now=e,clearTimeout(d.timerScroll),d.timerScroll=setTimeout(function(){i(c.scrollbars,"update")},f),clearTimeout(d.timerStop),d.timerStop=setTimeout(function(){l.scrollStop(c)},c.settings.scrollStopDelay)))},touchstart:function(a,b){o.pauseCheck=!1,b.settings.preventParentScroll&&i(b.scrollbars,"update",[!0])},touchend:function(a,b){clearTimeout(b.cache.timerStop)},scrollStop:function(a){a.fireCustomEvent("scrollstop"),o.pauseCheck=!1},wheel:function(a,b){var d,e=b.cache,f=a.deltaY||-a.wheelDeltaY/3||0;f=f>0?c.ceil(f):c.floor(f),d=e.v.percent+f/e.scrollH,f&&(0>=d||d>=100)&&a.preventDefault(),a.stopPropagation()}},m=function(a,d){var e="v"===a,f=d.element,i=d.scrollEl,j=d.settings,k=d.cache,l=k[a]={},m=e?"H":"W",n="client"+m,p="scroll"+m,q=e?"scrollTop":"scrollLeft",r=e?["top","bottom"]:["left","right"],s="height 0.2s ease 0s, width 0.2s ease 0s, opacity 0.2s ease 0s",t=!1,u=null,v=null,w=!1,x={dragData:null,dragStart:function(a){var b=a.touches?a.touches[0]:a;x.dragData={x:b.pageX,y:b.pageY,scroll:i[q]}},dragMove:function(a){var b,c,d=a.touches?a.touches[0]:a;x.dragData&&(a.preventDefault(),b=e?d.pageY-x.dragData.y:d.pageX-x.dragData.x,c=b/k[n],i[q]=x.dragData.scroll+c*k[p])},dragEnd:function(){x.dragData=null}};return{toggle:function(b){t=b,v&&(g(f,a+"track-on",t),t&&(v.style[o.cssTransition]=s)),l.enabled=t},create:function(){u=b.createElement("div"),v=b.createElement("b"),u.className=j.classPrefix+"-"+a,v.className=j.classPrefix+"-"+a+"track",u.appendChild(v),f.appendChild(u),j.draggableTracks&&this.bind(!0)},update:function(a){var b,d,f,g=this,m=j.minTrackSize||0,r=j.maxTrackSize||100;b=this.calc(i[q],k[n],k[p],m,r),d=1/b.size*b.position*100,f=c.abs(b.position-(l.position||0))*k[n],1===b.size&&t&&g.toggle(!1),b.size<1&&!t&&g.toggle(!0),v&&t&&(l.size!==b.size&&(v.style[e?"height":"width"]=100*b.size+"%"),f&&(g.animateTrack(o.isTouch&&f>20),v.style[o.cssTransform]="translate("+(e?"0%,"+d+"%":d+"%,0%")+")")),l=h(l,b),g.checkEdges(a)},animateTrack:function(a){(a||w)&&(v.style[o.cssTransition]=s+(a?", "+o.cssTransformDashed+" 0.2s linear 0s":"")),w=a},bind:function(a){var c=a?"addEventListener":"removeEventListener";o.isTouch?(v&&v[c]("touchstart",x.dragStart),b[c]("touchmove",x.dragMove),b[c]("mouseup",x.dragEnd)):(v&&v[c]("mousedown",x.dragStart),b[c]("mousemove",x.dragMove),b[c]("touchend",x.dragEnd))},calc:function(a,b,c,d,e){var f,g,h,i=d/100,j=e/100;return f=b/c,1===f||0===c?{position:0,size:1,percent:0}:(g=a/c,h=100*a/(c-b),f>j&&(g+=(f-j)*(h/100),f=j),i>f&&(g+=(f-i)*(h/100),f=i),0>h&&(g=0),h>100&&(g=1-f),{position:g,size:f,percent:h})},checkEdges:function(a){var b,c=l.percent;t&&(l.was===c||c%100!==0||a||(d.fireCustomEvent("scrollreachedge"),d.fireCustomEvent("scrollreach"+r[c/100])),c%100===0&&a&&j.preventParentScroll&&(b=c?l.position*k[p]-1:1,d.scrollTo(e?!1:b,e?b:!1,0,!0)),l.was=c)},remove:function(){this.toggle(!1),this.bind(!1),u&&u.parentNode&&u.parentNode.removeChild(u)}}},n={hideNativeScrollbars:function(a){if(0===o.nativeScrollbarSize){var b=p();a.setAttribute("data-scroll",b),a.style.display="none",o.isTouch?n.addCssRule('[data-scroll="'+b+'"]::-webkit-scrollbar',"display: none;"):n.addCssRule('[data-scroll="'+b+'"]::-webkit-scrollbar',"width: 0; height: 0;"),q(function(){a.style.display="block"})}else a.style.overflow="scroll",a.style.right=-o.nativeScrollbarSize+"px",a.style.bottom=-o.nativeScrollbarSize+"px"},exposedData:function(a){var b=a.scrollH,c=a.scrollW;return{scrollbarV:h({},a.v),scrollbarH:h({},a.h),scrollTop:a.v.position*b,scrollLeft:a.h.position*c,scrollBottom:(1-a.v.position-a.v.size)*b,scrollRight:(1-a.h.position-a.h.size)*c,scrollWidth:c,scrollHeight:b,clientWidth:a.clientW,clientHeight:a.clientH}},addCssRule:function(a,c){var d=b.getElementById("scroll-sheet");d||(d=b.createElement("style"),d.id="scroll-sheet",b.head.appendChild(d)),d.innerHTML+=a+"{"+c+"} "},checkLoop:function(){return o.instances.length?(o.pauseCheck||i(o.instances,"update"),void(k.checkFrequency&&(o.checkTimer=setTimeout(function(){n.checkLoop()},k.checkFrequency)))):void(o.checkTimer=null)},easingFunction:function(a){return--a*a*a+1}},o=j.G={isTouch:"ontouchstart"in a,cssTransition:f("transition"),cssTransform:f("transform"),nativeScrollbarSize:e(),instances:[],checkTimer:null,pauseCheck:!1};o.cssTransformDashed="transform"===o.cssTransform?o.cssTransform:"-"+o.cssTransform.replace("T","-t").toLowerCase();var p=Date.now||function(){return(new Date).getTime()},q=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)}}();"function"==typeof define&&define.amd&&define(function(){return j}),"undefined"!=typeof module&&module.exports&&(module.exports=j),a.Optiscroll=j}(window,document,Math);